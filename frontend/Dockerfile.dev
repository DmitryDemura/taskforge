FROM node:18-alpine
WORKDIR /app

ENV CI=true \
    CHOKIDAR_USEPOLLING=true \
    HOST=0.0.0.0 \
    NUXT_HOST=0.0.0.0 \
    NUXT_PORT=3001 \
    NUXT_EXPERIMENTAL_OXC=false \
    DISABLE_OXC=true

# Copy only package.json first
COPY package.json ./

# Install dependencies
RUN npm install --no-fund --no-audit

# Copy source code
COPY server.js ./

EXPOSE 3001

CMD ["npm", "run", "dev"]
